"use strict";function _createForOfIteratorHelper(e,t){var r,n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return n&&(e=n),r=0,{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function asyncGeneratorStep(e,t,r,n,a,o,i){try{var u=e[o](i),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,a)}function _asyncToGenerator(u){return function(){var e=this,i=arguments;return new Promise(function(t,r){var n=u.apply(e,i);function a(e){asyncGeneratorStep(n,t,r,a,o,"next",e)}function o(e){asyncGeneratorStep(n,t,r,a,o,"throw",e)}a(void 0)})}}var apiUrl="url/super/duper/game",Game=function(){console.log("hallo, vanuit een module");var s,f={gameState:null,oldGameState:null,gameToken:"",playerId:""},p=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Game.Data.get("https://jordilb.hbo-ict.org/api/Spel/Beurt/".concat(f.gameToken)));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),n=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n,a,o,i,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Game.Model.getGameState(f.gameToken);case 2:if(f.gameState=e.sent,null===f.oldGameState)Game.Reversi.showBoard(f.gameState.bord),Game.Stats.updateChart(f.gameState.bord);else if(f.gameState.bord!==f.oldGameState.bord){for(t=!1,r=0;r<8;r++)for(n=0;n<8;n++)a=f.oldGameState.bord[n][r],o=f.gameState.bord[n][r],a!==o&&(t=!0,Game.Reversi.showFiche(r,n,o));t&&Game.Stats.updateChart(f.gameState.bord)}return document.getElementById("kleur").innerHTML=f.gameState.speler1Token===f.playerId?"Kleur: Wit":"Kleur: Rood",i=document.getElementById("aanDeBeurt"),e.next=9,p();case 9:if(e.t0=e.sent,1!==e.t0){e.next=14;break}e.t1="Aan de beurt: Wit",e.next=15;break;case 14:e.t1="Aaan de beurt: Rood";case 15:if(i.innerHTML=e.t1,u=f.gameState.bord.map(function(e){return e.filter(function(e){return 1===e}).length}).reduce(function(e,t){return e+t}),c=f.gameState.bord.map(function(e){return e.filter(function(e){return 2===e}).length}).reduce(function(e,t){return e+t}),l="Wit: ".concat(u)+" - "+"Rood: ".concat(c),document.getElementById("score").innerHTML=l,f.gameState.isKlaar)return clearInterval(s),i.innerHTML=c<u?"Wit heeft gewonnen!":u<c?"Rood heeft gewonnen!":"Gelijk spel",e.next=26,p();e.next=34;break;case 26:if(e.t2=e.sent,1!==e.t2){e.next=31;break}e.t3=f.gameState.speler1Token,e.next=32;break;case 31:e.t3=f.gameState.speler2Token;case 32:e.t3===f.playerId&&$.get("https://jordilb.hbo-ict.org/Spel/Done/".concat(f.gameToken)).then(function(e){return e});case 34:f.oldGameState=f.gameState;case 35:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return{init:function(e,t){f.gameToken=t,f.playerId=e,Game.Template.init(),Game.Api.init(),Game.Stats.init(),n(),s=setInterval(n,2e3)},doeZet:function(){var r=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:if(e.t0=e.sent,1!==e.t0){e.next=7;break}e.t1=f.gameState.speler1Token,e.next=8;break;case 7:e.t1=f.gameState.speler2Token;case 8:if(e.t1===f.playerId)return e.next=12,Game.Data.put("https://jordilb.hbo-ict.org/api/spel/".concat(f.gameToken,"/zet?token=").concat(f.playerId,"&x=").concat(t,"&y=").concat(r));e.next=14;break;case 12:return e.next=14,n();case 14:case"end":return e.stop()}},e)}));return function(e,t){return r.apply(this,arguments)}}()}}(),FeedbackWidget=(Game.Data=function(){console.log("hallo, vanuit module Data");function t(t){var r=e.mock.find(function(e){return e.url===t});return new Promise(function(e,t){e(r)})}var e={mock:[{url:"api/Spel/Beurt",data:0}]},r="production";return{init:function(e){if("development"===r)return t(e);if("production"!==r)throw new Error("de environment is geen development of production")},get:function(e){return"production"===r?$.get(e).then(function(e){return e}).catch(function(e){console.log(e.message)}):"development"===r?t(e):void 0},put:function(e){return"production"===r?new Promise(function(t){$.ajax({url:e,type:"PUT",success:function(e){t(e)}})}):"development"===r?t(e):void 0},funFact:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get("https://api.aakhilv.me/fun/facts");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()}}(),Game.Model=function(){console.log("hallo, vanuit module Model");return{init:function(){console.log("private model")},weather:function(e){Game.Data.get(e).then(function(e){if(null==e.main.temp)throw new Error("Geen temperatuur");console.log(e)})},getGameState:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Game.Data.get("https://jordilb.hbo-ict.org/api/spel/".concat(t));case 2:return(r=e.sent).bord=function(e){for(var t,r=[],n=0;n<8;n++)r.push([0,0,0,0,0,0,0,0]);for(t in e){var a=e[t],o=t.split(",");r[o[0]][o[1]]=a}return r}(r.bord),e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()}}(),Game.Reversi=function(){console.log("hallo, vanuit module Reversi");return{init:function(){console.log("private spel")},showBoard:function(e){document.querySelector(".board").innerHTML=Game.Template.parseTemplate("reversi.board",{board:e});for(var t=function(n){for(var e=0;e<8;e++)!function(t){var r=document.querySelector(".board-row-y-".concat(n,".board-row-x-").concat(t));r.addEventListener("click",function(e){0<r.children.length||Game.doeZet(t,n)})}(e)},r=0;r<8;r++)t(r)},showFiche:function(e,t,r){t=document.querySelector(".board-row-y-".concat(t,".board-row-x-").concat(e)),e=document.createElement("div");e.classList.add("fade-in"),e.classList.add("fiche-".concat(r)),t.innerHTML="",t.append(e)}}}(),function(){function t(e){_classCallCheck(this,t),_defineProperty(this,"count",1),this._elementId=e}return _createClass(t,[{key:"elementId",get:function(){return this._elementId}},{key:"show",value:function(e,t){var r=document.getElementById(this._elementId);r.style.display="block",$(r).text(e),"danger"===t?($(r).addClass("alert alert-danger"),$(r).removeClass("alert alert-success")):"success"===t&&($(r).addClass("alert alert-success"),$(r).removeClass("alert alert-danger")),this.log({message:e,type:t}),console.log(this.history())}},{key:"hide",value:function(){document.getElementById(this._elementId).style.display="none"}},{key:"log",value:function(e){var t=this.count-10;10<=localStorage.length&&(localStorage.removeItem("feedback_widget"+t),console.log("boven de 10")),localStorage.setItem("feedback_widget"+this.count,JSON.stringify(e)),this.count++}},{key:"removelog",value:function(){for(var e=this.count-10;e<this.count;e++)localStorage.removeItem("feedback_widget"+e);for(e=0;e<10;e++)localStorage.removeItem("feedback_widget"+e)}},{key:"history",value:function(){for(var e=[],t=this.count-localStorage.length;t<this.count;t++)e.push(JSON.parse(localStorage.getItem("feedback_widget"+t)));var r="";for(t=0;t<e.length;t++)r+=e[t].type+" - "+e[t].message+"\n";return r}}]),t}());Game.Api=function(){function e(){return(e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("funFact"),e.next=3,n();case 3:r=e.sent,t.innerHTML=Game.Template.parseTemplate("api.funFact",{fact:r});case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function n(){return t.apply(this,arguments)}function t(){return(t=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Game.Data.funFact();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}return{init:function(){return e.apply(this,arguments)},funFact:n}}(),Game.Stats=function(){var r={myChart:null,player1:[],player2:[]};function n(){var e,t=$("#myChart");null!=(e=r.myChart)&&e.destroy(),r.myChart=new Chart(t,{type:"line",data:{labels:r.player1.map(function(e,t){return t+1}),datasets:[{label:"Wit",data:r.player1,fill:!1,borderColor:"rgb(255,255,255)",tension:.1},{label:"Rood",data:r.player2,fill:!1,borderColor:"rgb(255,0,0)",tension:.1}]},options:{scales:{y:{beginAtZero:!0,color:"rgb(255,255,255)",grid:{color:"rgb(255,255,255)"},title:{color:"rgb(255,255,255)"}},x:{color:"rgb(255,255,255)",grid:{color:"rgb(255,255,255)"},title:{color:"rgb(255,255,255)"}}}}})}return{init:n,updateChart:function(e){var t=e.map(function(e){return e.filter(function(e){return 1===e}).length}).reduce(function(e,t){return e+t}),e=e.map(function(e){return e.filter(function(e){return 2===e}).length}).reduce(function(e,t){return e+t});r.player1.push(t),r.player2.push(e),n()}}}(),Game.Template=function(){function r(e){var t,r=spa_templates.templates,n=_createForOfIteratorHelper(e.split("."));try{for(n.s();!(t=n.n()).done;)r=r[t.value]}catch(e){n.e(e)}finally{n.f()}return r}return{init:function(){Handlebars.registerHelper("ifeq",function(e,t,r){return e===t?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("ifnoteq",function(e,t,r){return e!==t?r.fn(this):r.inverse(this)})},getTemplate:r,parseTemplate:function(e,t){return r(e)(t)}}}();